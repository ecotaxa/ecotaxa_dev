<div style="margin: 3px;">
Particle Project {{ PrjId }} : {{ Prj.ptitle }}<br>

<a href="/Task/Create/TaskPartZooscanImport?p={{ PrjId }}" class="btn btn-sm btn-primary"><span class="glyphicon glyphicon-import"></span> Import sample from disk</a>
<a href="/part/prjedit/{{ PrjId }}" class="btn btn-sm btn-primary"><span class="glyphicon glyphicon-pencil"></span> Edit project metadata</a>
<a href="/part/prj/" class="btn btn-sm btn-primary"><span class="glyphicon glyphicon-arrow-left"></span> Back to project list</a>


<h4>Project samples dashboard</h4>
<form action="/part/prjcalc/{{ PrjId }}" method="post" id="FormSamples">
<table id="tblsample2" class="table table-bordered table-condensed" style="width: auto;">
  <tr>
    <th style="text-align: center;">Select<br>
      <input type="checkbox" id="checkall" onclick="$('#tblsample2 td input').prop('checked',$(this).prop('checked'))" >
    </th>
    <th>ID</th>
    <th>profileid</th>
    <th>filename</th>
    <th>stationid</th>
    <th>firstimage</th>
    <th>lastimg</th>
    <th>lastimgused</th>
    <th>Raw Part. Histo</th>
    <th>Det Part. Histo</th>
    <th>Reduced Part. Histo</th>
    <th>Ecotaxa Sample ID</th>
    <th>Taxonomy Histo</th>
    <th>Taxonomy Recalc Date</th>
    <th>CTD Data</th>
    <th>CTD Import Date</th>
    <th>comment</th>
  </tr>
{% for r in dbsample %}
  <tr>
    <td><input type="checkbox" name="s_{{ r['psampleid'] }}" value="Y" ></td>
    <td>{{ r['psampleid'] }} <a href="/part/sampleedit/{{ r['psampleid'] }}"><span class="glyphicon glyphicon-pencil"></span></a></td>
    <td>{{ r['profileid'] }}</td>
    <td>{{ r['filename'] }}</td>
    <td>{{ r['stationid'] }}</td>
    <td>{{ r['firstimage'] }}</td>
    <td>{{ r['lastimg'] }}</td>
    <td>{{ r['lastimgused'] }}</td>
    <td>{{ r['histobrutavailable'] }}</td>
    <td>{{ r['nbrlinedet'] }}</td>
    <td>{{ r['nbrlinereduit'] }}</td>
    <td>{{ r['sampleid'] or ''}}</td>
    <td>{{ r['nbrlinetaxo'] }}</td>
    <td>{{ r['daterecalculhistotaxo']|datetime }}</td>
    <td>{{ r['nbrlinectd'] }}</td>
    <td>{{ r['ctd_import_datetime']|datetime }}</td>
    <td>{{ r['comment'] }}</td>
  </tr>
  {% endfor %}
</table>
<p >
  <b>Action : </b>
<input type="checkbox" name="dohistodet" value="Y"> Compute detailled histogram
- <input type="checkbox" name="dohistored" value="Y"> Compute reduced histogram
- <input type="checkbox" name="domatchecotaxa" value="Y"> Match Ecotaxa sample
- <input type="checkbox" name="dohistotaxo" value="Y"> Compute taxonomy histogram
- <input type="checkbox" name="doctdimport" value="Y"> CTD Import
  <button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-cog"></span> Start operation</button>
</p>
</form>
</div>
<button type="button" onclick="$('#confirm').modal('show')" class="btn btn-xs btn-danger"><span class="glyphicon glyphicon-erase"></span> Remove selected samples</button>


<div class="modal " id="confirm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="ModalLabel">Are you sure you want remove selected samples</h4>
      </div>
      <div class="modal-body">

    <button type="button" onclick="ProcessDeleteSamples()" class="btn btn-danger"><span class="glyphicon glyphicon-erase"></span> Confirm Remove samples</button>

    <button  type="button" class="btn btn-warning" onclick="$('#confirm').modal('hide')"> Cancel</button>

      </div>
    </div>
  </div>
</div>
<script src="/static/common.js"></script>
<script>
  function ProcessDeleteSamples()
  {
    var postdata={'delete':'Y'};
    var champs=$('#FormSamples').serializeArray();
    for(i=0;i<champs.length;i++){
      var c=champs[i];
      postdata[c['name']]=c['value'];
    }
    PostDynForm("/part/prjcalc/{{ PrjId }}",postdata);
  }

</script>
